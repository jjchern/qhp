---
output:
  md_document:
    variant: markdown_github
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "README-"
)
```

[![Travis-CI Build Status](https://travis-ci.org/jjchern/qhp.svg?branch=master)](https://travis-ci.org/jjchern/qhp)


# About

This package includes Qualified Health Plan (qhp) data in the Health Insurance Marketplace.

# Installation

```r
# install.packages("devtools")
devtools::install_github("jjchern/qhp")
```

# Links

- [ASPE AFFORDABLE CARE ACT RESEARCH](http://aspe.hhs.gov/affordable-care-act-research)
- [PLAN SELECTIONS BY ZIP CODE IN THE HEALTH INSURANCE MARKETPLACE, 2014](http://aspe.hhs.gov/plan-selections-zip-code-health-insurance-marketplace-september-2014)
- [PLAN SELECTIONS BY ZIP CODE IN THE HEALTH INSURANCE MARKETPLACE,
2015](http://aspe.hhs.gov/plan-selections-zip-code-health-insurance-marketplace-april-2015)
- [HEALTH PLAN DATASETS](https://www.healthcare.gov/health-and-dental-plan-datasets-for-researchers-and-issuers/)

# Usage

```{r, message=FALSE, warning=FALSE}
library(dplyr)

qhp::enrollment2014
qhp::enrollment2015

# 2014: Top 10 counties with residents enrolling in FFM
# Sorted according to total enrollment
qhp::enrollment2014 %>% 
  na.omit() %>% 
  group_by(countygeoid) %>% 
  summarise(countyname = first(countyname),
            enrollment = sum(PlanSelections),
            state = first(state),
            copop = first(copop)) %>% 
  arrange(desc(enrollment))

# Sorted according to enrollment per 100,000 residents
qhp::enrollment2014 %>% 
  na.omit() %>% 
  group_by(countygeoid) %>% 
  summarise(countyname = first(countyname),
            enrollment = sum(PlanSelections),
            state = first(state),
            copop = first(copop)) %>% 
  mutate(enroll_per100000 = enrollment / copop * 100000) %>% 
  filter(copop >= 100000) %>% 
  arrange(desc(enroll_per100000))

# 2014: Total enrollment by states
qhp::enrollment2014 %>% 
  na.omit() %>% 
  group_by(state) %>% 
  summarise(statename = first(StateName),
            enrollment = sum(PlanSelections)) %>% 
  arrange(enrollment %>% desc) %>% 
  print(n = 36)


# 2015: Top 10 counties with residents enrolling in FFM
# Sorted according to total enrollment
qhp::enrollment2015 %>% 
  na.omit() %>% 
  group_by(countygeoid) %>% 
  summarise(countyname = first(countyname),
            enrollment = sum(PlanSelections),
            state = first(state),
            copop = first(copop)) %>% 
  arrange(desc(enrollment))

# Sorted according to enrollment per 1000 residents
qhp::enrollment2015 %>% 
  na.omit() %>% 
  group_by(countygeoid) %>% 
  summarise(countyname = first(countyname),
            enrollment = sum(PlanSelections),
            state = first(state),
            copop = first(copop)) %>% 
  mutate(enroll_per100000 = enrollment / copop * 100000) %>% 
  filter(copop >= 100000) %>% 
  arrange(desc(enroll_per100000))

# 2015: Total enrollment by states
qhp::enrollment2015 %>% 
  na.omit() %>% 
  group_by(state) %>% 
  summarise(statename = first(StateName),
            enrollment = sum(PlanSelections)) %>% 
  arrange(enrollment %>% desc) %>% 
  print(n = 37)

# Health Plan Data
qhp::qhp2014
```

